import sys, os, unittest
# relative module import stuff
root_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
sys.path.append(root_dir)
import gsxor

class GSXORTests(unittest.TestCase):
  """Tests for GS XOR encryption algorithm."""
  def test_gsxor(self):
    data = bytes([
      0x73, 0x31, 0x00, 0x5B, 0x73, 0x31, 0x00, 0x73, 0x32, 0x36, 0x30, 0x00, 0x62, 0x00, 0x00, 0x01,
      0x04, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0xA8, 0xE9, 0x3D, 0x55, 0x27, 0x4B, 0xE0, 0xAA, 0xCE, 0x4E, 0xFF,
      0x77, 0xD0, 0x29, 0x66, 0x1C, 0xF7, 0x45, 0xC0, 0xF4, 0x93, 0x4C, 0xCB, 0xF0, 0xD0, 0xAF, 0x7C,
      0x30, 0x4F, 0x71, 0x69, 0x8F, 0x85, 0x16, 0xF0, 0x55, 0x49, 0x21, 0x93, 0x19, 0x62, 0xF6, 0xF2,
      0x04, 0x57, 0x2C, 0xDD, 0x23, 0xC6, 0xBA, 0x6C, 0xB5, 0xDD, 0x20, 0xA7, 0xD3, 0x60, 0x96, 0x75,
      0x4B, 0xD7, 0xE8, 0x9A, 0x5B, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x00, 0x00, 0x00, 0x03, 0x5D
    ])
    
    enc = gsxor.encrypt(data)
    dec = gsxor.decrypt(enc)
    self.assertEqual(data, dec)

if __name__ == '__main__':
  unittest.main()
